# The spinfile.yaml for spin_python is required since building the documentation
# requires a provisioned project.
plugin_packages:
    - spin_docs
    - '../spin_python'

plugins:
    - spin_python:
          - python
          - behave
          - pytest
          - radon
          - devpi
    - spin_docs.sphinx

python:
    version: '3.11.9'
    requirements:
        - sphinx-rtd-theme

sphinx:
    build_dir: _build

build_rules:
    task docs:
        sources: doc/_schemaref.rst
    doc/_schemaref.rst:
        sources: [src/spin_python]
        spin:
            - schemadoc behave --rst -o doc/plugins/behave_schemaref.rst
            - schemadoc devpi --rst -o doc/plugins/devpi_schemaref.rst
            - schemadoc radon --rst -o doc/plugins/radon_schemaref.rst
            - schemadoc python --rst -o doc/plugins/python_schemaref.rst
            - schemadoc pytest --rst -o doc/plugins/pytest_schemaref.rst
