# The spinfile.yaml for spin_python is required since building the documentation
# requires a provisioned project.
plugin_packages:
    - spin_docs
    - -e .

plugins:
    - spin_docs.sphinx
    - spin_python:
          - aws_auth
          - behave
          - debugpy
          - devpi
          - playwright
          - pytest
          - python
          - radon

environment:
    AWS_AUTH_DISABLE: true

python:
    version: '3.11.9'
    requirements:
        - sphinx-rtd-theme

pytest:
    tests: [tests]

build_rules:
    task docs:
        sources: doc/_schemaref.rst
    doc/_schemaref.rst:
        sources: [src/spin_python]
        spin:
            - schemadoc aws_auth --rst -o doc/plugins/aws_auth_schemaref.rst
            - schemadoc behave --rst -o doc/plugins/behave_schemaref.rst
            - schemadoc debugpy --rst -o doc/plugins/debugpy_schemaref.rst
            - schemadoc devpi --rst -o doc/plugins/devpi_schemaref.rst
            - schemadoc radon --rst -o doc/plugins/radon_schemaref.rst
            - schemadoc playwright --rst -o doc/plugins/playwright_schemaref.rst
            - schemadoc python --rst -o doc/plugins/python_schemaref.rst
            - schemadoc pytest --rst -o doc/plugins/pytest_schemaref.rst
