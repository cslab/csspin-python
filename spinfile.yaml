# The spinfile.yaml for csspin-python is required since building the
# documentation requires a provisioned project.
spin:
    project_name: csspin-python
    index_url: https://packages.contact.de/tools/stable/+simple

plugin_packages:
    - csspin-docs
    - -e .[aws_auth,uv]

plugins:
    - csspin_docs.sphinx
    - csspin_python:
          - behave
          - debugpy
          - devpi
          - playwright
          - pytest
          - python
          - radon
          - uv_provisioner

python:
    version: 3.11.10
    requirements:
        - sphinx-rtd-theme
    index_url: https://packages.contact.de/apps/16.0/+simple/

uv_provisioner:
    enabled: true

pytest:
    tests: [tests]

build_rules:
    task docs:
        sources: doc/_schemaref.rst
    doc/_schemaref.rst:
        sources: [src/csspin_python]
        spin:
            - schemadoc behave --rst -o doc/plugins/behave_schemaref.rst
            - schemadoc debugpy --rst -o doc/plugins/debugpy_schemaref.rst
            - schemadoc devpi --rst -o doc/plugins/devpi_schemaref.rst
            - schemadoc radon --rst -o doc/plugins/radon_schemaref.rst
            - schemadoc playwright --rst -o doc/plugins/playwright_schemaref.rst
            - schemadoc python --rst -o doc/plugins/python_schemaref.rst
            - schemadoc pytest --rst -o doc/plugins/pytest_schemaref.rst
            - schemadoc uv_provisioner --rst -o doc/plugins/uv_provisioner_schemaref.rst
